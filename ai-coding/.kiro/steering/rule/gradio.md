---
inclusion: fileMatch
fileMatchPattern: "*.py"
---
## Gradio 代码规范
### 模块化
- 模块化目录结构，将不同页面、工具函数、配置等分离
- 全局配置（标题、主题、端口等）通过 config.py 集中管理，避免硬编码
- 调用 page.render() 将子页面嵌入主应用
- “模块化、低耦合、高可读”：通过目录分离页面与工具函数，用清晰的函数封装页面逻辑，集中管理全局配置与状态
### 页面模块 
- 页面导航优先使用 gr.Tabs（直观）或 gr.Radio+gr.update（动态切换）
- 每个页面作为独立模块，通过函数返回 Gradio 组件gr.Blocks
- 每个页面用独立函数（如 create_xxx_page）封装，返回 gr.Blocks 
- 页面内逻辑（组件交互、事件）在函数内部实现，避免全局变量
- 页面标题通过 gr.Blocks(title=...) 显式指定，便于导航识别
- 复杂页面可拆分为子函数（如单独定义组件布局、事件绑定）
- 每个页面函数添加文档字符串（说明页面功能、参数 / 返回值）
### 1. 界面组织
- 复杂界面拆分为多个组件，放在 `ui/components/` 目录
- 使用 `gr.Blocks` 而非 `gr.Interface` 构建复杂界面
- 界面布局遵循一致性原则，保持统一的视觉风格

### 2. 组件命名
- 组件变量名使用蛇形命名法，后缀包含组件类型
- 示例：`user_input_textbox`, `submit_button`, `result_dataframe`

### 3. 事件处理
- 事件处理函数放在对应组件模块中
- 处理函数命名格式：`on_{event}_{component_name}`
- 示例：`on_click_submit_button`
- 长时间运行的操作必须使用 `gr.update()` 更新状态，并考虑异步处理
- 事件处理函数放在单独的 handlers.py 文件中
- 事件处理函数需添加类型提示
- 耗时操作必须使用 queue=True 和进度指示器
- 错误处理：事件处理中捕获的异常需显示用户友好的错误消息
### 4. 状态管理
- 使用 `gr.State` 存储会话状态，如用户信息、当前语言等
- 避免在界面组件中存储大量数据，使用后端服务存储
- 状态变量命名前缀为 `state_`
- 复杂状态使用数据类或字典封装，避免多个独立状态变量
- 状态变更需有明确的触发机制和反馈
- 敏感状态信息需加密存储
### 5. 样式规范
- 使用统一的 CSS 类管理样式，避免硬编码样式
- 响应式设计，适应不同屏幕尺寸
- 错误提示使用统一的样式和位置

### 6. 性能优化
- 避免不必要的组件更新
- 大型数据展示使用分页或懒加载
- 频繁更新的组件考虑使用 `every` 参数定时更新

### 7.  组件组织
- 界面组件按功能模块化，每个组件单独封装
- 复杂界面使用布局容器（gr.Row, gr.Column）组织
- 相关功能的组件放在同一个组（gr.Accordion 或 gr.TabItem）
- 保持一致的组件间距和对齐方式
- 页面间复用的组件（如模型选择器、设置面板）放在 pages/common/ 中，通过函数返回实例，避免重复定义
- 多页面需共享的状态（如全局模型实例、用户配置）使用 gr.State，在主应用中定义并传递给子页面
### 8.  国际化实现
- 所有文本元素使用翻译函数 _() 包裹
- 语言切换通过 gr.Dropdown 实现，选项为支持的语言
- 语言切换时触发界面重渲染，更新所有文本
### 9.  响应式设计
- 界面需适应不同屏幕尺寸
- 使用 scale 和 min_width 参数控制组件响应式行为
- 在移动设备上优化布局，避免横向滚动
- 重要操作按钮位置保持一致
### 10.  用户体验规范
- 所有操作需有明确的反馈（加载动画、成功 / 失败提示）
- 表单提交前进行客户端验证，显示即时错误提示
- 长时间运行的任务显示进度条
- 提供清晰的导航和操作指引
- 保持界面简洁，避免信息过载